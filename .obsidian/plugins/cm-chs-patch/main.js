/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source visit the plugins github repository
*/

var Xe=Object.create;var q=Object.defineProperty;var Ze=Object.getOwnPropertyDescriptor;var Qe=Object.getOwnPropertyNames,oe=Object.getOwnPropertySymbols,tn=Object.getPrototypeOf,se=Object.prototype.hasOwnProperty,en=Object.prototype.propertyIsEnumerable;var le=(r,t,e)=>t in r?q(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,z=(r,t)=>{for(var e in t||(t={}))se.call(t,e)&&le(r,e,t[e]);if(oe)for(var e of oe(t))en.call(t,e)&&le(r,e,t[e]);return r};var ae=r=>q(r,"__esModule",{value:!0});var nn=(r,t)=>{ae(r);for(var e in t)q(r,e,{get:t[e],enumerable:!0})},rn=(r,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Qe(t))!se.call(r,n)&&n!=="default"&&q(r,n,{get:()=>t[n],enumerable:!(e=Ze(t,n))||e.enumerable});return r},C=r=>rn(ae(q(r!=null?Xe(tn(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var k=(r,t,e)=>new Promise((n,i)=>{var o=a=>{try{l(e.next(a))}catch(h){i(h)}},s=a=>{try{l(e.throw(a))}catch(h){i(h)}},l=a=>a.done?n(a.value):Promise.resolve(a.value).then(o,s);l((e=e.apply(r,t)).next())});nn(exports,{default:()=>ie});var Ye=C(require("obsidian"));function it(r,t){let e=Object.keys(t).map(n=>on(r,n,t[n]));return e.length===1?e[0]:function(){e.forEach(n=>n())}}function on(r,t,e){let n=r[t],i=r.hasOwnProperty(t),o=e(n);return n&&Object.setPrototypeOf(o,n),Object.setPrototypeOf(s,o),r[t]=s,l;function s(...a){return o===n&&r[t]===s&&l(),o.apply(this,a)}function l(){r[t]===s&&(i?r[t]=n:delete r[t]),o!==n&&(o=n,Object.setPrototypeOf(s,n||Function))}}var sn=r=>{var t;return((t=window.CodeMirror)==null?void 0:t.prototype)?it(window.CodeMirror.prototype,{findWordAt:e=>function(n){let i=e.call(this,n),o=this.indexFromPos(n),s=i.from(),l=this.indexFromPos(s),a=i.to(),h=this.indexFromPos(a),u=this.getRange(s,a),c=r.getChsSegFromRange(o,{from:l,to:h,text:u});if(c){let{from:d,to:f}=c;i.anchor=this.posFromIndex(d),i.head=this.posFromIndex(f)}return i}}):null},ln=r=>{let t=sn(r);t&&r.register(t)},he=ln;var Be=C(require("@codemirror/state"));var pt=C(require("@codemirror/state")),Ve=C(require("@codemirror/view"));function rt(r){return r.nodeType==3?_t(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function Rt(r){for(var t=0;;t++)if(r=r.previousSibling,!r)return t}function ue(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}var Tt={left:0,right:0,top:0,bottom:0};function ot(r,t){let e=t?r.left:r.right;return{left:e,right:e,top:r.top,bottom:r.bottom}}var ce;function _t(r,t,e=t){let n=ce||(ce=document.createRange());return n.setEnd(r,e),n.setStart(r,t),n}function st(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}var p;(function(i){i[i.Not=0]="Not",i[i.Child=1]="Child",i[i.Node=2]="Node",i[i.Attrs=4]="Attrs"})(p||(p={}));var S=class{constructor(t,e,n=!0){this.node=t;this.offset=e;this.precise=n}static before(t,e){return new S(t.parentNode,Rt(t),e)}static after(t,e){return new S(t.parentNode,Rt(t)+1,e)}},lt=[],y=class{constructor(){this.parent=null;this.dom=null;this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let n of this.children){if(n==t)return e;e+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}coordsAt(t,e){return null}sync(t){if(this.dirty&2){let e=this.dom,n=e.firstChild;for(let i of this.children){if(i.dirty){if(!i.dom&&n){let o=y.get(n);(!o||!o.parent&&o.constructor==i.constructor)&&i.reuseDOM(n)}i.sync(t),i.dirty=0}if(t&&!t.written&&t.node==e&&n!=i.dom&&(t.written=!0),i.dom.parentNode==e){for(;n&&n!=i.dom;)n=fe(n);n=i.dom.nextSibling}else e.insertBefore(i.dom,n)}for(n&&t&&t.node==e&&(t.written=!0);n;)n=fe(n)}else if(this.dirty&1)for(let e of this.children)e.dirty&&(e.sync(t),e.dirty=0)}reuseDOM(t){}localPosFromDOM(t,e){let n;if(t==this.dom)n=this.dom.childNodes[e];else{let i=ue(t)==0?0:e==0?-1:1;for(;;){let o=t.parentNode;if(o==this.dom)break;i==0&&o.firstChild!=o.lastChild&&(t==o.firstChild?i=-1:i=1),t=o}i<0?n=t:n=t.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!y.get(n);)n=n.nextSibling;if(!n)return this.length;for(let i=0,o=0;;i++){let s=this.children[i];if(s.dom==n)return o;o+=s.length+s.breakAfter}}domBoundsAround(t,e,n=0){let i=-1,o=-1,s=-1,l=-1;for(let a=0,h=n,u=n;a<this.children.length;a++){let c=this.children[a],d=h+c.length;if(h<t&&d>e)return c.domBoundsAround(t,e,h);if(d>=t&&i==-1&&(i=a,o=h),h>e&&c.dom.parentNode==this.dom){s=a,l=u;break}u=d,h=d+c.breakAfter}return{from:o,to:l<0?n+this.length:l,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(t=!1){this.dirty|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.dirty|=2),e.dirty&1)return;e.dirty|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.dirty&&this.markParentsDirty(!0))}setDOM(t){this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,n=lt){this.markDirty();for(let i=t;i<e;i++){let o=this.children[i];o.parent==this&&o.destroy()}this.children.splice(t,e-t,...n);for(let i=0;i<n.length;i++)n[i].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new de(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}merge(t,e,n,i,o,s){return!1}become(t){return!1}getSide(){return 0}destroy(){this.parent=null}};y.prototype.breakAfter=0;function fe(r){let t=r.nextSibling;return r.parentNode.removeChild(r),t}var de=class{constructor(t,e,n){this.children=t;this.pos=e;this.i=n;this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}};function an(r,t,e,n,i,o,s,l,a){let{children:h}=r,u=h.length?h[t]:null,c=o.length?o[o.length-1]:null,d=c?c.breakAfter:s;if(!(t==n&&u&&!s&&!d&&o.length<2&&u.merge(e,i,o.length?c:null,e==0,l,a))){if(n<h.length){let f=h[n];f&&i<f.length?(t==n&&(f=f.split(i),i=0),!d&&c&&f.merge(0,i,c,!0,0,a)?o[o.length-1]=f:(i&&f.merge(0,i,null,!1,0,a),o.push(f))):f?.breakAfter&&(c?c.breakAfter=1:s=1),n++}for(u&&(u.breakAfter=s,e>0&&(!s&&o.length&&u.merge(e,u.length,o[0],!1,l,0)?u.breakAfter=o.shift().breakAfter:(e<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(e,u.length,null,!1,l,0),t++));t<n&&o.length;)if(h[n-1].become(o[o.length-1]))n--,o.pop(),a=o.length?0:l;else if(h[t].become(o[0]))t++,o.shift(),l=o.length?0:a;else break;!o.length&&t&&n<h.length&&!h[t-1].breakAfter&&h[n].merge(0,0,h[t-1],!1,l,a)&&t--,(t<n||o.length)&&r.replaceChildren(t,n,o)}}function at(r,t,e,n,i,o){let s=r.childCursor(),{i:l,off:a}=s.findPos(e,1),{i:h,off:u}=s.findPos(t,-1),c=t-e;for(let d of n)c+=d.length;r.length+=c,an(r,h,u,l,a,n,0,i,o)}var O="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(r=>r?parseInt(r,36):1);for(let r=1;r<O.length;r++)O[r]+=O[r-1];function hn(r){for(let t=1;t<O.length;t+=2)if(O[t]>r)return O[t-1]<=r;return!1}function me(r){return r>=127462&&r<=127487}var ge=8205;function G(r,t,e=!0,n=!0){return(e?pe:un)(r,t,n)}function pe(r,t,e){if(t==r.length)return t;t&&be(r.charCodeAt(t))&&we(r.charCodeAt(t-1))&&t--;let n=Nt(r,t);for(t+=xe(n);t<r.length;){let i=Nt(r,t);if(n==ge||i==ge||e&&hn(i))t+=xe(i),n=i;else if(me(i)){let o=0,s=t-2;for(;s>=0&&me(Nt(r,s));)o++,s-=2;if(o%2==0)break;t+=2}else break}return t}function un(r,t,e){for(;t>0;){let n=pe(r,t-2,e);if(n<t)return n;t--}return 0}function be(r){return r>=56320&&r<57344}function we(r){return r>=55296&&r<56320}function Nt(r,t){let e=r.charCodeAt(t);if(!we(e)||t+1==r.length)return e;let n=r.charCodeAt(t+1);return be(n)?(e-55296<<10)+(n-56320)+65536:e}function xe(r){return r<65536?1:2}var A=class{constructor(){}lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,n){let i=[];return this.decompose(0,t,i,2),n.length&&n.decompose(0,n.length,i,1|2),this.decompose(e,this.length,i,1),E.from(i,this.length-(e-t)+n.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){let n=[];return this.decompose(t,e,n,0),E.from(n,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),n=this.length-this.scanIdentical(t,-1),i=new V(this),o=new V(t);for(let s=e,l=e;;){if(i.next(s),o.next(s),s=0,i.lineBreak!=o.lineBreak||i.done!=o.done||i.value!=o.value)return!1;if(l+=i.value.length,i.done||l>=n)return!0}}iter(t=1){return new V(this,t)}iterRange(t,e=this.length){return new Dt(this,t,e)}iterLines(t,e){let n;if(t==null)n=this.iter();else{e==null&&(e=this.lines+1);let i=this.line(t).from;n=this.iterRange(i,Math.max(i,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new It(n)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?A.empty:t.length<=32?new m(t):E.from(m.split(t,[]))}},m=class extends A{constructor(t,e=cn(t)){super();this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,n,i){for(let o=0;;o++){let s=this.text[o],l=i+s.length;if((e?n:l)>=t)return new ke(i,l,n,s);i=l+1,n++}}decompose(t,e,n,i){let o=t<=0&&e>=this.length?this:new m(ye(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(i&1){let s=n.pop(),l=ht(o.text,s.text.slice(),0,o.length);if(l.length<=32)n.push(new m(l,s.length+o.length));else{let a=l.length>>1;n.push(new m(l.slice(0,a)),new m(l.slice(a)))}}else n.push(o)}replace(t,e,n){if(!(n instanceof m))return super.replace(t,e,n);let i=ht(this.text,ht(n.text,ye(this.text,0,t)),e),o=this.length+n.length-(e-t);return i.length<=32?new m(i,o):E.from(m.split(i,[]),o)}sliceString(t,e=this.length,n=`
`){let i="";for(let o=0,s=0;o<=e&&s<this.text.length;s++){let l=this.text[s],a=o+l.length;o>t&&s&&(i+=n),t<a&&e>o&&(i+=l.slice(Math.max(0,t-o),e-o)),o=a+1}return i}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let n=[],i=-1;for(let o of t)n.push(o),i+=o.length+1,n.length==32&&(e.push(new m(n,i)),n=[],i=-1);return i>-1&&e.push(new m(n,i)),e}},E=class extends A{constructor(t,e){super();this.children=t,this.length=e,this.lines=0;for(let n of t)this.lines+=n.lines}lineInner(t,e,n,i){for(let o=0;;o++){let s=this.children[o],l=i+s.length,a=n+s.lines-1;if((e?a:l)>=t)return s.lineInner(t,e,n,i);i=l+1,n=a+1}}decompose(t,e,n,i){for(let o=0,s=0;s<=e&&o<this.children.length;o++){let l=this.children[o],a=s+l.length;if(t<=a&&e>=s){let h=i&((s<=t?1:0)|(a>=e?2:0));s>=t&&a<=e&&!h?n.push(l):l.decompose(t-s,e-s,n,h)}s=a+1}}replace(t,e,n){if(n.lines<this.lines)for(let i=0,o=0;i<this.children.length;i++){let s=this.children[i],l=o+s.length;if(t>=o&&e<=l){let a=s.replace(t-o,e-o,n),h=this.lines-s.lines+a.lines;if(a.lines<h>>5-1&&a.lines>h>>5+1){let u=this.children.slice();return u[i]=a,new E(u,this.length-(e-t)+n.length)}return super.replace(o,l,a)}o=l+1}return super.replace(t,e,n)}sliceString(t,e=this.length,n=`
`){let i="";for(let o=0,s=0;o<this.children.length&&s<=e;o++){let l=this.children[o],a=s+l.length;s>t&&o&&(i+=n),t<a&&e>s&&(i+=l.sliceString(t-s,e-s,n)),s=a+1}return i}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof E))return 0;let n=0,[i,o,s,l]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;i+=e,o+=e){if(i==s||o==l)return n;let a=this.children[i],h=t.children[o];if(a!=h)return n+a.scanIdentical(h,e);n+=a.length+1}}static from(t,e=t.reduce((n,i)=>n+i.length+1,-1)){let n=0;for(let f of t)n+=f.lines;if(n<32){let f=[];for(let b of t)b.flatten(f);return new m(f,e)}let i=Math.max(32,n>>5),o=i<<1,s=i>>1,l=[],a=0,h=-1,u=[];function c(f){let b;if(f.lines>o&&f instanceof E)for(let nt of f.children)c(nt);else f.lines>s&&(a>s||!a)?(d(),l.push(f)):f instanceof m&&a&&(b=u[u.length-1])instanceof m&&f.lines+b.lines<=32?(a+=f.lines,h+=f.length+1,u[u.length-1]=new m(b.text.concat(f.text),b.length+1+f.length)):(a+f.lines>i&&d(),a+=f.lines,h+=f.length+1,u.push(f))}function d(){a!=0&&(l.push(u.length==1?u[0]:E.from(u,h)),h=-1,a=u.length=0)}for(let f of t)c(f);return d(),l.length==1?l[0]:new E(l,e)}};A.empty=new m([""],0);function cn(r){let t=-1;for(let e of r)t+=e.length+1;return t}function ht(r,t,e=0,n=1e9){for(let i=0,o=0,s=!0;o<r.length&&i<=n;o++){let l=r[o],a=i+l.length;a>=e&&(a>n&&(l=l.slice(0,n-i)),i<e&&(l=l.slice(e-i)),s?(t[t.length-1]+=l,s=!1):t.push(l)),i=a+1}return t}function ye(r,t,e){return ht(r,[""],t,e)}var V=class{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof m?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,i=this.nodes[n],o=this.offsets[n],s=o>>1,l=i instanceof m?i.text.length:i.children.length;if(s==(e>0?l:0)){if(n==0)return this.done=!0,this.value="",this;e>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((o&1)==(e>0?0:1)){if(this.offsets[n]+=e,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(i instanceof m){let a=i.text[s+(e<0?-1:0)];if(this.offsets[n]+=e,a.length>Math.max(0,t))return this.value=t==0?a:e>0?a.slice(t):a.slice(0,a.length-t),this;t-=a.length}else{let a=i.children[s+(e<0?-1:0)];t>a.length?(t-=a.length,this.offsets[n]+=e):(e<0&&this.offsets[n]--,this.nodes.push(a),this.offsets.push(e>0?1:(a instanceof m?a.text.length:a.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}},Dt=class{constructor(t,e,n){this.value="",this.done=!1,this.cursor=new V(t,e>n?-1:1),this.pos=e>n?t.length:0,this.from=Math.min(e,n),this.to=Math.max(e,n)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let n=e<0?this.pos-this.from:this.to-this.pos;t>n&&(t=n),n-=t;let{value:i}=this.cursor.next(t);return this.pos+=(i.length+t)*e,this.value=i.length<=n?i:e<0?i.slice(i.length-n):i.slice(0,n),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}},It=class{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:n,value:i}=this.inner.next(t);return e?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}};typeof Symbol!="undefined"&&(A.prototype[Symbol.iterator]=function(){return this.iter()},V.prototype[Symbol.iterator]=Dt.prototype[Symbol.iterator]=It.prototype[Symbol.iterator]=function(){return this});var ke=class{constructor(t,e,n,i){this.from=t,this.to=e,this.number=n,this.text=i}get length(){return this.to-this.from}};var v=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},Ot=typeof document!="undefined"?document:{documentElement:{style:{}}},Vt=/Edge\/(\d+)/.exec(v.userAgent),ve=/MSIE \d/.test(v.userAgent),Lt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(v.userAgent),ut=!!(ve||Lt||Vt),Se=!ut&&/gecko\/(\d+)/i.test(v.userAgent),Bt=!ut&&/Chrome\/(\d+)/.exec(v.userAgent),Ce="webkitFontSmoothing"in Ot.documentElement.style,Ae=!ut&&/Apple Computer/.test(v.vendor),Ee=Ae&&(/Mobile\/\w+/.test(v.userAgent)||v.maxTouchPoints>2),L={mac:Ee||/Mac/.test(v.platform),windows:/Win/.test(v.platform),linux:/Linux|X11/.test(v.platform),ie:ut,ie_version:ve?Ot.documentMode||6:Lt?+Lt[1]:Vt?+Vt[1]:0,gecko:Se,gecko_version:Se?+(/Firefox\/(\d+)/.exec(v.userAgent)||[0,0])[1]:0,chrome:!!Bt,chrome_version:Bt?+Bt[1]:0,ios:Ee,android:/Android\b/.test(v.userAgent),webkit:Ce,safari:Ae,webkit_version:Ce?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:Ot.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};var fn=256,P=class extends y{constructor(t){super();this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,e,n){return n&&(!(n instanceof P)||this.length-(e-t)+n.length>fn)?!1:(this.text=this.text.slice(0,t)+(n?n.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new P(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new S(this.dom,t)}domBoundsAround(t,e,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return dn(this.dom,t,e)}},R=class extends y{constructor(t,e=[],n=0){super();this.mark=t;this.children=e;this.length=n;for(let i of e)i.setParent(this)}setAttrs(t){if(st(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.dirty|=p.Attrs|p.Node)}sync(t){this.dom?this.dirty&p.Attrs&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t)}merge(t,e,n,i,o,s){return n&&(!(n instanceof R&&n.mark.eq(this.mark))||t&&o<=0||e<this.length&&s<=0)?!1:(at(this,t,e,n?n.children:[],o-1,s-1),this.markDirty(),!0)}split(t){let e=[],n=0,i=-1,o=0;for(let l of this.children){let a=n+l.length;a>t&&e.push(n<t?l.split(t-n):l),i<0&&n>=t&&(i=o),n=a,o++}let s=this.length-t;return this.length=t,i>-1&&(this.children.length=i,this.markDirty()),new R(this.mark,e,s)}domAtPos(t){return Ft(this.dom,this.children,t)}coordsAt(t,e){return Ht(this,t,e)}};function dn(r,t,e){let n=r.nodeValue.length;t>n&&(t=n);let i=t,o=t,s=0;t==0&&e<0||t==n&&e>=0?L.chrome||L.gecko||(t?(i--,s=1):(o++,s=-1)):e<0?i--:o++;let l=_t(r,i,o).getClientRects();if(!l.length)return Tt;let a=l[(s?s<0:e>=0)?0:l.length-1];return L.safari&&!s&&a.width==0&&(a=Array.prototype.find.call(l,h=>h.width)||a),s?ot(a,s<0):a||null}var T=class extends y{constructor(t,e,n){super();this.widget=t;this.length=e;this.side=n;this.prevWidget=null}static create(t,e,n){return new(t.customView||T)(t,e,n)}split(t){let e=T.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(t,e,n,i,o,s){return n&&(!(n instanceof T)||!this.widget.compare(n.widget)||t>0&&o<=0||e<this.length&&s<=0)?!1:(this.length=t+(n?n.length:0)+(this.length-e),!0)}become(t){return t.length==this.length&&t instanceof T&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.eq(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return A.empty;let t=this;for(;t.parent;)t=t.parent;let e=t.editorView,n=e&&e.state.doc,i=this.posAtStart;return n?n.slice(i,i+this.length):A.empty}domAtPos(t){return t==0?S.before(this.dom):S.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let n=this.dom.getClientRects(),i=null;if(!n.length)return Tt;for(let o=t>0?n.length-1:0;i=n[o],!(t>0?o==0:o==n.length-1||i.top<i.bottom);o+=t>0?-1:1);return t==0&&e>0||t==this.length&&e<=0?i:ot(i,t==0)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}};var U=class extends y{constructor(t){super();this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof U&&t.side==this.side}split(){return new U(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return S.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return A.empty}};P.prototype.children=T.prototype.children=U.prototype.children=lt;function Ft(r,t,e){let n=0;for(let i=0;n<t.length;n++){let o=t[n],s=i+o.length;if(!(s==i&&o.getSide()<=0)){if(e>i&&e<s&&o.dom.parentNode==r)return o.domAtPos(e-i);if(e<=i)break;i=s}}for(;n>0;n--){let i=t[n-1].dom;if(i.parentNode==r)return S.after(i)}return new S(r,0)}function Wt(r,t,e){let n,{children:i}=r;e>0&&t instanceof R&&i.length&&(n=i[i.length-1])instanceof R&&n.mark.eq(t.mark)?Wt(n,t.children[0],e-1):(i.push(t),t.setParent(r)),r.length+=t.length}function Ht(r,t,e){for(let o=0,s=0;s<r.children.length;s++){let l=r.children[s],a=o+l.length,h;if((e<=0||a==r.length||l.getSide()>0?a>=t:a>t)&&(t<a||s+1==r.children.length||(h=r.children[s+1]).length||h.getSide()>0)){let u=0;if(a==o){if(l.getSide()<=0)continue;u=e=-l.getSide()}let c=l.coordsAt(Math.max(0,t-o),e);return u&&c?ot(c,e<0):c}o=a}let n=r.dom.lastChild;if(!n)return r.dom.getBoundingClientRect();let i=rt(n);return i[i.length-1]||null}var J=C(require("@codemirror/state"));var Me=C(require("@codemirror/state")),_=class{eq(t){return this==t}range(t,e=t){return new ct(t,e,this)}};_.prototype.startSide=_.prototype.endSide=0;_.prototype.point=!1;_.prototype.mapMode=Me.MapMode.TrackDel;var ct=class{constructor(t,e,n){this.from=t,this.to=e,this.value=n}};function jt(r,t){return r.from-t.from||r.value.startSide-t.value.startSide}var ft=class{constructor(t,e,n,i){this.from=t,this.to=e,this.value=n,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(t,e,n,i=0){let o=n?this.to:this.from;for(let s=i,l=o.length;;){if(s==l)return s;let a=s+l>>1,h=o[a]-t||(n?this.value[a].endSide:this.value[a].startSide)-e;if(a==s)return h>=0?s:l;h>=0?l=a:s=a+1}}between(t,e,n,i){for(let o=this.findIndex(e,-1e9,!0),s=this.findIndex(n,1e9,!1,o);o<s;o++)if(i(this.from[o]+t,this.to[o]+t,this.value[o])===!1)return!1}map(t,e){let n=[],i=[],o=[],s=-1,l=-1;for(let a=0;a<this.value.length;a++){let h=this.value[a],u=this.from[a]+t,c=this.to[a]+t,d,f;if(u==c){let b=e.mapPos(u,h.startSide,h.mapMode);if(b==null||(d=f=b,h.startSide!=h.endSide&&(f=e.mapPos(u,h.endSide),f<d)))continue}else if(d=e.mapPos(u,h.startSide),f=e.mapPos(c,h.endSide),d>f||d==f&&h.startSide>0&&h.endSide<=0)continue;(f-d||h.endSide-h.startSide)<0||(s<0&&(s=d),h.point&&(l=Math.max(l,f-d)),n.push(h),i.push(d-s),o.push(f-s))}return{mapped:n.length?new ft(i,o,n,l):null,pos:s}}},x=class{constructor(t,e,n=x.empty,i){this.chunkPos=t,this.chunk=e,this.nextLayer=n,this.maxPoint=i}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:n=!1,filterFrom:i=0,filterTo:o=this.length}=t,s=t.filter;if(e.length==0&&!s)return this;if(n&&(e=e.slice().sort(jt)),this.isEmpty)return e.length?x.of(e):this;let l=new qt(this,null,-1).goto(0),a=0,h=[],u=new $;for(;l.value||a<e.length;)if(a<e.length&&(l.from-e[a].from||l.startSide-e[a].value.startSide)>=0){let c=e[a++];u.addInner(c.from,c.to,c.value)||h.push(c)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==e.length||this.chunkEnd(l.chunkIndex)<e[a].from)&&(!s||i>this.chunkEnd(l.chunkIndex)||o<this.chunkPos[l.chunkIndex])&&u.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!s||i>l.to||o<l.from||s(l.from,l.to,l.value))&&(u.addInner(l.from,l.to,l.value)||h.push(new ct(l.from,l.to,l.value))),l.next());return u.finishInner(this.nextLayer.isEmpty&&!h.length?x.empty:this.nextLayer.update({add:h,filter:s,filterFrom:i,filterTo:o}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],n=[],i=-1;for(let s=0;s<this.chunk.length;s++){let l=this.chunkPos[s],a=this.chunk[s],h=t.touchesRange(l,l+a.length);if(h===!1)i=Math.max(i,a.maxPoint),e.push(a),n.push(t.mapPos(l));else if(h===!0){let{mapped:u,pos:c}=a.map(l,t);u&&(i=Math.max(i,u.maxPoint),e.push(u),n.push(c))}}let o=this.nextLayer.map(t);return e.length==0?o:new x(n,e,o,i)}between(t,e,n){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let o=this.chunkPos[i],s=this.chunk[i];if(e>=o&&t<=o+s.length&&s.between(o,t-o,e-o,n)===!1)return}this.nextLayer.between(t,e,n)}}iter(t=0){return B.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return B.from(t).goto(e)}static compare(t,e,n,i,o=-1){let s=t.filter(c=>c.maxPoint>0||!c.isEmpty&&c.maxPoint>=o),l=e.filter(c=>c.maxPoint>0||!c.isEmpty&&c.maxPoint>=o),a=Pe(s,l,n),h=new F(s,a,o),u=new F(l,a,o);n.iterGaps((c,d,f)=>Re(h,c,u,d,f,i)),n.empty&&n.length==0&&Re(h,0,u,0,0,i)}static eq(t,e,n=0,i){i==null&&(i=1e9);let o=t.filter(u=>!u.isEmpty&&e.indexOf(u)<0),s=e.filter(u=>!u.isEmpty&&t.indexOf(u)<0);if(o.length!=s.length)return!1;if(!o.length)return!0;let l=Pe(o,s),a=new F(o,l,0).goto(n),h=new F(s,l,0).goto(n);for(;;){if(a.to!=h.to||!Gt(a.active,h.active)||a.point&&(!h.point||!a.point.eq(h.point)))return!1;if(a.to>i)return!0;a.next(),h.next()}}static spans(t,e,n,i,o=-1){var s;let l=new F(t,null,o,(s=i.filterPoint)===null||s===void 0?void 0:s.bind(i)).goto(e),a=e,h=l.openStart;for(;;){let u=Math.min(l.to,n);if(l.point?(i.point(a,u,l.point,l.activeForPoint(l.to),h),h=l.openEnd(u)+(l.to>u?1:0)):u>a&&(i.span(a,u,l.active,h),h=l.openEnd(u)),l.to>n)break;a=l.to,l.next()}return h}static of(t,e=!1){let n=new $;for(let i of t instanceof ct?[t]:e?mn(t):t)n.add(i.from,i.to,i.value);return n.finish()}};x.empty=new x([],[],null,-1);function mn(r){if(r.length>1)for(let t=r[0],e=1;e<r.length;e++){let n=r[e];if(jt(t,n)>0)return r.slice().sort(jt);t=n}return r}x.empty.nextLayer=x.empty;var $=class{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(t){this.chunks.push(new ft(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}add(t,e,n){this.addInner(t,e,n)||(this.nextLayer||(this.nextLayer=new $)).add(t,e,n)}addInner(t,e,n){let i=t-this.lastTo||n.startSide-this.last.endSide;if(i<=0&&(t-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=n,this.lastFrom=t,this.lastTo=e,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let n=e.value.length-1;return this.last=e.value[n],this.lastFrom=e.from[n]+t,this.lastTo=e.to[n]+t,!0}finish(){return this.finishInner(x.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=new x(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}};function Pe(r,t,e){let n=new Map;for(let o of r)for(let s=0;s<o.chunk.length;s++)o.chunk[s].maxPoint<=0&&n.set(o.chunk[s],o.chunkPos[s]);let i=new Set;for(let o of t)for(let s=0;s<o.chunk.length;s++){let l=n.get(o.chunk[s]);l!=null&&(e?e.mapPos(l):l)==o.chunkPos[s]&&!(e==null?void 0:e.touchesRange(l,l+o.chunk[s].length))&&i.add(o.chunk[s])}return i}var qt=class{constructor(t,e,n,i=0){this.layer=t,this.skip=e,this.minPoint=n,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,n){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<t||i.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],n=t+e.from[this.rangeIndex];if(this.from=n,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.to-t.to||this.endSide-t.endSide}},B=class{constructor(t){this.heap=t}static from(t,e=null,n=-1){let i=[];for(let o=0;o<t.length;o++)for(let s=t[o];!s.isEmpty;s=s.nextLayer)s.maxPoint>=n&&i.push(new qt(s,e,n,o));return i.length==1?i[0]:new B(i)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let n of this.heap)n.goto(t,e);for(let n=this.heap.length>>1;n>=0;n--)zt(this.heap,n);return this.next(),this}forward(t,e){for(let n of this.heap)n.forward(t,e);for(let n=this.heap.length>>1;n>=0;n--)zt(this.heap,n);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),zt(this.heap,0)}}};function zt(r,t){for(let e=r[t];;){let n=(t<<1)+1;if(n>=r.length)break;let i=r[n];if(n+1<r.length&&i.compare(r[n+1])>=0&&(i=r[n+1],n++),e.compare(i)<0)break;r[n]=e,r[t]=i,t=n}}var F=class{constructor(t,e,n,i=()=>!0){this.minPoint=n,this.filterPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=B.from(t,e,n)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){dt(this.active,t),dt(this.activeTo,t),dt(this.activeRank,t),this.minActive=Te(this.active,this.activeTo)}addActive(t){let e=0,{value:n,to:i,rank:o}=this.cursor;for(;e<this.activeRank.length&&this.activeRank[e]<=o;)e++;mt(this.active,e,n),mt(this.activeTo,e,i),mt(this.activeRank,e,o),t&&mt(t,e,this.cursor.from),this.minActive=Te(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let n=this.openStart<0?[]:null,i=0;for(;;){let o=this.minActive;if(o>-1&&(this.activeTo[o]-this.cursor.from||this.active[o].endSide-this.cursor.startSide)<0){if(this.activeTo[o]>t){this.to=this.activeTo[o],this.endSide=this.active[o].endSide;break}this.removeActive(o),n&&dt(n,o)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(n),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else if(!this.filterPoint(this.cursor.from,this.cursor.to,this.cursor.value,this.cursor.rank))this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.from<t&&(i=1),this.cursor.next(),this.to>t&&this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){let o=0;for(;o<n.length&&n[o]<t;)o++;this.openStart=o+i}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>t||this.activeTo[n]==t&&this.active[n].endSide>=this.point.endSide)&&e.push(this.active[n]);return e.reverse()}openEnd(t){let e=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>t;n--)e++;return e}};function Re(r,t,e,n,i,o){r.goto(t),e.goto(n);let s=n+i,l=n,a=n-t;for(;;){let h=r.to+a-e.to||r.endSide-e.endSide,u=h<0?r.to+a:e.to,c=Math.min(u,s);if(r.point||e.point?r.point&&e.point&&(r.point==e.point||r.point.eq(e.point))&&Gt(r.activeForPoint(r.to+a),e.activeForPoint(e.to))||o.comparePoint(l,c,r.point,e.point):c>l&&!Gt(r.active,e.active)&&o.compareRange(l,c,r.active,e.active),u>s)break;l=u,h<=0&&r.next(),h>=0&&e.next()}}function Gt(r,t){if(r.length!=t.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!=t[e]&&!r[e].eq(t[e]))return!1;return!0}function dt(r,t){for(let e=t,n=r.length-1;e<n;e++)r[e]=r[e+1];r.pop()}function mt(r,t,e){for(let n=r.length-1;n>=t;n--)r[n+1]=r[n];r[t]=e}function Te(r,t){let e=-1,n=1e9;for(let i=0;i<t.length;i++)(t[i]-n||r[i].endSide-r[e].endSide)<0&&(e=i,n=t[i]);return e}function Ut(r,t){for(let e in r)e=="class"&&t.class?t.class+=" "+r.class:e=="style"&&t.style?t.style+=";"+r.style:t[e]=r[e];return t}function K(r,t){if(r==t)return!0;if(!r||!t)return!1;let e=Object.keys(r),n=Object.keys(t);if(e.length!=n.length)return!1;for(let i of e)if(n.indexOf(i)==-1||r[i]!==t[i])return!1;return!0}function _e(r,t,e){if(t)for(let n in t)e&&n in e||r.removeAttribute(n);if(e)for(let n in e)t&&t[n]==e[n]||r.setAttribute(n,e[n])}var w;(function(c){c[c.NonIncEnd=-5e8]="NonIncEnd",c[c.BlockBefore=-4e8]="BlockBefore",c[c.BlockIncStart=-3e8]="BlockIncStart",c[c.Line=-2e8]="Line",c[c.InlineBefore=-1e8]="InlineBefore",c[c.InlineIncStart=-1]="InlineIncStart",c[c.InlineIncEnd=1]="InlineIncEnd",c[c.InlineAfter=1e8]="InlineAfter",c[c.BlockIncEnd=2e8]="BlockIncEnd",c[c.BlockAfter=3e8]="BlockAfter",c[c.NonIncStart=4e8]="NonIncStart"})(w||(w={}));var N;(function(i){i[i.Text=0]="Text",i[i.WidgetBefore=1]="WidgetBefore",i[i.WidgetAfter=2]="WidgetAfter",i[i.WidgetRange=3]="WidgetRange"})(N||(N={}));var Y=class extends _{constructor(t,e,n,i){super();this.startSide=t;this.endSide=e;this.widget=n;this.spec=i}get heightRelevant(){return!1}static mark(t){return new X(t)}static widget(t){let e=t.side||0,n=!!t.block;return e+=n?e>0?3e8:-4e8:e>0?1e8:-1e8,new H(t,e,e,n,t.widget||null,!1)}static replace(t){let e=!!t.block,{start:n,end:i}=Ne(t,e),o=(n?e?-3e8:-1:4e8)-1,s=(i?e?2e8:1:-5e8)+1;return new H(t,o,s,e,t.widget||null,!0)}static line(t){return new W(t)}static set(t,e=!1){return x.of(t,e)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}};Y.none=x.empty;var X=class extends Y{constructor(t){let{start:e,end:n}=Ne(t);super(e?-1:4e8,n?1:-5e8,null,t);this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){return this==t||t instanceof X&&this.tagName==t.tagName&&this.class==t.class&&K(this.attrs,t.attrs)}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}};X.prototype.point=!1;var W=class extends Y{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof W&&K(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}};W.prototype.mapMode=J.MapMode.TrackBefore;W.prototype.point=!0;var H=class extends Y{constructor(t,e,n,i,o,s){super(e,n,o,t);this.block=i;this.isReplace=s;this.mapMode=i?e<=0?J.MapMode.TrackBefore:J.MapMode.TrackAfter:J.MapMode.TrackDel}get type(){return this.startSide<this.endSide?3:this.startSide<=0?1:2}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(t){return t instanceof H&&gn(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}};H.prototype.point=!0;function Ne(r,t=!1){let{inclusiveStart:e,inclusiveEnd:n}=r;return e==null&&(e=r.inclusive),n==null&&(n=r.inclusive),{start:e??t,end:n??t}}function gn(r,t){return r==t||!!(r&&t&&r.compare(t))}var pn=C(require("@codemirror/state")),D=class extends y{constructor(){super(...arguments);this.children=[];this.length=0;this.prevAttrs=void 0;this.attrs=null;this.breakAfter=0}merge(t,e,n,i,o,s){if(n){if(!(n instanceof D))return!1;this.dom||n.transferDOM(this)}return i&&this.setDeco(n?n.attrs:null),at(this,t,e,n?n.children:[],o,s),!0}split(t){let e=new D;if(e.breakAfter=this.breakAfter,this.length==0)return e;let{i:n,off:i}=this.childPos(t);i&&(e.append(this.children[n].split(i),0),this.children[n].merge(i,this.children[n].length,null,!1,0,0),n++);for(let o=n;o<this.children.length;o++)e.append(this.children[o],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=t,e}transferDOM(t){!this.dom||(t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){K(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){Wt(this,t,e)}addLineDeco(t){let e=t.spec.attributes,n=t.spec.class;e&&(this.attrs=Ut(e,this.attrs||{})),n&&(this.attrs=Ut({class:n},this.attrs||{}))}domAtPos(t){return Ft(this.dom,this.children,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.dirty|=p.Attrs|p.Node)}sync(t){this.dom?this.dirty&p.Attrs&&(st(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(_e(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t);let e=this.dom.lastChild;for(;e&&y.get(e)instanceof R;)e=e.lastChild;if(!e||e.nodeName!="BR"&&y.get(e)?.isEditable==!1&&(!L.ios||!this.children.some(n=>n instanceof P))){let n=document.createElement("BR");n.cmIgnore=!0,this.dom.appendChild(n)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0;for(let e of this.children){if(!(e instanceof P))return null;let n=rt(e.dom);if(n.length!=1)return null;t+=n[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length}}coordsAt(t,e){return Ht(this,t,e)}become(t){return!1}get type(){return N.Text}static find(t,e){for(let n=0,i=0;n<t.children.length;n++){let o=t.children[n],s=i+o.length;if(s>=e){if(o instanceof D)return o;if(s>e)break}i=s+o.breakAfter}return null}};var gt=C(require("@codemirror/state"));function $t(r,t,e=1){let n=r.charCategorizer(t),i=r.doc.lineAt(t),o=t-i.from;if(i.length==0)return gt.EditorSelection.cursor(t);o==0?e=1:o==i.length&&(e=-1);let s=o,l=o;e<0?s=G(i.text,o,!1):l=G(i.text,o);let a=n(i.text.slice(s,l));for(;s>0;){let h=G(i.text,s,!1);if(n(i.text.slice(h,s))!=a)break;s=h}for(;l<i.length;){let h=G(i.text,l);if(n(i.text.slice(l,h))!=a)break;l=h}return gt.EditorSelection.range(s+i.from,l+i.from)}var De=(r,t)=>r>=t.top&&r<=t.bottom,Ie=(r,t,e)=>De(t,e)&&r>=e.left&&r<=e.right;function bn(r,t,e,n){let i=D.find(r.docView,t);if(!i)return 1;let o=t-i.posAtStart;if(o==0)return 1;if(o==i.length)return-1;let s=i.coordsAt(o,-1);if(s&&Ie(e,n,s))return-1;let l=i.coordsAt(o,1);return l&&Ie(e,n,l)?1:s&&De(n,s)?-1:1}function Kt(r,t){let e=r.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:e,bias:bn(r,e,t.clientX,t.clientY)}}var Oe=C(require("@codemirror/state"));function Z(r,t,e,n){if(!e)return null;let{from:i,to:o}=e,s=n.doc.sliceString(i,o),l=r.getChsSegFromRange(t,{from:i,to:o,text:s});return l?Oe.EditorSelection.range(l.from,l.to):e}var Le=r=>{let t=(n,i,o,s)=>Z(r,i,$t(n.state,i,o),n.state);return[Ve.EditorView.mouseSelectionStyle.of((n,i)=>{if(i.button!==0||i.detail!==2)return null;let o=Kt(n,i),s=i.detail,l=n.state.selection,a=o,h=i;return{update(u){u.docChanged&&(o&&(o.pos=u.changes.mapPos(o.pos)),l=l.map(u.changes),h=null)},get(u,c,d){let f;if(h&&u.clientX==h.clientX&&u.clientY==h.clientY?f=a:(f=a=Kt(n,u),h=u),!f||!o)return l;let b=t(n,f.pos,f.bias,s);if(o.pos!=f.pos&&!c){let nt=t(n,o.pos,o.bias,s),Pt=Math.min(nt.from,b.from),re=Math.max(nt.to,b.to);b=Pt<b.from?pt.EditorSelection.range(Pt,re):pt.EditorSelection.range(re,Pt)}return c?l.replaceRange(l.main.extend(b.from,b.to)):d?l.addRange(b):pt.EditorSelection.create([b])}}})]};var wn=r=>{r.registerEditorExtension(Le(r)),r.register(it(Be.EditorState.prototype,{wordAt:t=>function(e){return Z(r,e,t.call(this,e),this)}}))},Fe=wn;var Jt=class extends Error{},We=class extends Jt{},He=class extends Jt{},xn=(r,t=",")=>r.join(t),yn={accept:"*",multiple:!1,strict:!1},je=r=>{let{accept:t,multiple:e,strict:n}={...yn,...r},i=Sn({multiple:e,accept:Array.isArray(t)?xn(t):t});return new Promise(o=>{i.onchange=()=>{o(kn(i.files,e,n)),i.remove()},i.click()})},kn=(r,t,e)=>new Promise((n,i)=>{if(!r)return i(new We);let o=vn(r,t,e);if(!o)return i(new He);n(o)}),vn=(r,t,e)=>!t&&e?r.length===1?r[0]:null:r.length?r:null,Sn=({accept:r,multiple:t})=>{let e=document.createElement("input");return e.type="file",e.multiple=t,e.accept=r,e};var qe=C(require("obsidian")),Cn="var(--background-modifier-success)",An="var(--background-modifier-cover)",bt=class extends qe.Modal{constructor(t){super(t.app);this.plugin=t;this.reloadButton=null;this.selectButton=null;this.downloadLink=`https://github.com/aidenlx/cm-chs-patch/blob/master/assets/jiaba-wasm/${this.libName}.zip?raw=true`;this.lanzoumLink="https://wwe.lanzoum.com/igUPR00jp02h";this.modalEl.addClass("zt-install-guide")}get libName(){return this.plugin.libName}onOpen(){this.contentEl.createEl("h1",{text:"\u5B89\u88C5\u7ED3\u5DF4\u5206\u8BCD"}),this.contentEl.createDiv({},t=>{t.appendText("\u65B0\u7248\u5206\u8BCD\u63D2\u4EF6\u9700\u8981\u5B89\u88C5 jieba-wasm\uFF0C\u8BF7\u6309\u7167\u4E0B\u9762\u7684\u6B65\u9AA4\u5B89\u88C5\uFF1A"),t.createEl("ol",{},e=>{e.createEl("li",{},n=>{n.appendText("\u70B9\u51FB\u94FE\u63A5\u4E0B\u8F7D "),n.createEl("code",{text:this.libName+".zip"}),n.createEl("br"),n.appendText("\u4ECE "),n.createEl("a",{href:this.downloadLink,text:"GitHub"}),n.appendText(" \u6216 "),n.createEl("a",{href:this.lanzoumLink,text:"\u84DD\u594F\u4E91"}),n.appendText(" \u4E0B\u8F7D")}),e.createEl("li",{},n=>{n.appendText("\u89E3\u538B\u7F29zip\u5305\u5F97\u5230 "),n.createEl("code",{text:this.libName})}),e.createEl("li",{},n=>{n.appendText("\u5728\u5F39\u51FA\u7684\u7A97\u53E3\u9009\u62E9 "),n.createEl("code",{text:this.libName}),this.selectButton=n.createEl("button",{text:"\u9009\u62E9\u6587\u4EF6"},i=>i.onclick=this.onSelectingFile.bind(this))}),e.createEl("li",{},n=>{n.appendText("\u91CD\u65B0\u52A0\u8F7D\u5206\u8BCD\u63D2\u4EF6: "),this.reloadButton=n.createEl("button",{text:"\u91CD\u65B0\u52A0\u8F7D"},i=>{i.disabled=!0,i.style.backgroundColor=An,i.onclick=this.onReloadPlugin.bind(this)})})})})}onClose(){this.contentEl.empty()}onSelectingFile(){return k(this,null,function*(){let t=yield je({multiple:!1,accept:".wasm",strict:!0});!t||(yield this.app.vault.adapter.writeBinary(this.plugin.libPath,yield t.arrayBuffer()),this.selectButton&&(this.selectButton.setText("\u7ED3\u5DF4\u5206\u8BCD\u5BFC\u5165\u6210\u529F"),this.selectButton.style.backgroundColor=Cn),this.reloadButton&&(this.reloadButton.disabled=!1,this.reloadButton.style.backgroundColor=""))})}onReloadPlugin(){return k(this,null,function*(){yield this.app.plugins.disablePlugin(this.plugin.manifest.id),this.close(),yield this.app.plugins.enablePlugin(this.plugin.manifest.id)})}};var _n={},g,ze=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});ze.decode();var wt=null;function xt(){return(wt===null||wt.buffer!==g.memory.buffer)&&(wt=new Uint8Array(g.memory.buffer)),wt}function Yt(r,t){return ze.decode(xt().subarray(r,r+t))}var M=new Array(32).fill(void 0);M.push(void 0,null,!0,!1);var Q=M.length;function tt(r){Q===M.length&&M.push(M.length+1);let t=Q;return Q=M[t],M[t]=r,t}function yt(r){return M[r]}function En(r){r<36||(M[r]=Q,Q=r)}function et(r){let t=yt(r);return En(r),t}function Xt(r){let t=typeof r;if(t=="number"||t=="boolean"||r==null)return`${r}`;if(t=="string")return`"${r}"`;if(t=="symbol"){let i=r.description;return i==null?"Symbol":`Symbol(${i})`}if(t=="function"){let i=r.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(r)){let i=r.length,o="[";i>0&&(o+=Xt(r[0]));for(let s=1;s<i;s++)o+=", "+Xt(r[s]);return o+="]",o}let e=/\[object ([^\]]+)\]/.exec(toString.call(r)),n;if(e.length>1)n=e[1];else return toString.call(r);if(n=="Object")try{return"Object("+JSON.stringify(r)+")"}catch{return"Object"}return r instanceof Error?`${r.name}: ${r.message}
${r.stack}`:n}var j=0,kt=new TextEncoder("utf-8"),Mn=typeof kt.encodeInto=="function"?function(r,t){return kt.encodeInto(r,t)}:function(r,t){let e=kt.encode(r);return t.set(e),{read:r.length,written:e.length}};function vt(r,t,e){if(e===void 0){let l=kt.encode(r),a=t(l.length);return xt().subarray(a,a+l.length).set(l),j=l.length,a}let n=r.length,i=t(n),o=xt(),s=0;for(;s<n;s++){let l=r.charCodeAt(s);if(l>127)break;o[i+s]=l}if(s!==n){s!==0&&(r=r.slice(s)),i=e(i,n,n=s+r.length*3);let l=xt().subarray(i+s,i+n);s+=Mn(r,l).written}return j=s,i}var St=null;function Ct(){return(St===null||St.buffer!==g.memory.buffer)&&(St=new Int32Array(g.memory.buffer)),St}var At=null;function Pn(){return(At===null||At.buffer!==g.memory.buffer)&&(At=new Uint32Array(g.memory.buffer)),At}function Rn(r,t){let n=Pn().subarray(r/4,r/4+t),i=[];for(let o=0;o<n.length;o++)i.push(et(n[o]));return i}function Zt(r,t){try{let l=g.__wbindgen_add_to_stack_pointer(-16);var e=vt(r,g.__wbindgen_malloc,g.__wbindgen_realloc),n=j;g.cut(l,e,n,t);var i=Ct()[l/4+0],o=Ct()[l/4+1],s=Rn(i,o).slice();return g.__wbindgen_free(i,o*4),s}finally{g.__wbindgen_add_to_stack_pointer(16)}}function Qt(r){return r==null}function Et(r,t,e){var n=vt(r,g.__wbindgen_malloc,g.__wbindgen_realloc),i=j,o=Qt(e)?0:vt(e,g.__wbindgen_malloc,g.__wbindgen_realloc),s=j,l=g.add_word(n,i,!Qt(t),Qt(t)?0:t,o,s);return l>>>0}async function Tn(r,t){if(typeof Response=="function"&&r instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(r,t)}catch(n){if(r.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}let e=await r.arrayBuffer();return await WebAssembly.instantiate(e,t)}else{let e=await WebAssembly.instantiate(r,t);return e instanceof WebAssembly.Instance?{instance:e,module:r}:e}}async function Ge(r){typeof r=="undefined"&&(r=new URL("jieba_rs_wasm_bg.wasm",_n.url));let t={};t.wbg={},t.wbg.__wbindgen_string_new=function(i,o){var s=Yt(i,o);return tt(s)},t.wbg.__wbindgen_object_drop_ref=function(i){et(i)},t.wbg.__wbg_new_68adb0d58759a4ed=function(){var i=new Object;return tt(i)},t.wbg.__wbindgen_number_new=function(i){var o=i;return tt(o)},t.wbg.__wbg_set_2e79e744454afade=function(i,o,s){yt(i)[et(o)]=et(s)},t.wbg.__wbindgen_object_clone_ref=function(i){var o=yt(i);return tt(o)},t.wbg.__wbg_new_7031805939a80203=function(i,o){var s=new Error(Yt(i,o));return tt(s)},t.wbg.__wbindgen_debug_string=function(i,o){var s=Xt(yt(o)),l=vt(s,g.__wbindgen_malloc,g.__wbindgen_realloc),a=j;Ct()[i/4+1]=a,Ct()[i/4+0]=l},t.wbg.__wbindgen_throw=function(i,o){throw new Error(Yt(i,o))},t.wbg.__wbindgen_rethrow=function(i){throw et(i)},(typeof r=="string"||typeof Request=="function"&&r instanceof Request||typeof URL=="function"&&r instanceof URL)&&(r=fetch(r));let{instance:e,module:n}=await Tn(await r,t);return g=e.exports,Ge.__wbindgen_wasm_module=n,g}var Ue=Ge;var Nn=r=>r&&Number.isInteger(+r)?+r:void 0,$e=r=>r&&r in Dn?r:void 0,te=!1,Ke=(r,t)=>k(void 0,null,function*(){if(te)return;let e=[];if(yield Ue(r),t)for(let n of t.split(/\r?\n/)){let[i,o,s]=n.trim().split(/\s+/),l,a;if(!i){e.push(n);continue}!o&&!s?Et(i):(a=$e(o))?Et(i,void 0,a):(a=$e(s),l=Nn(o),Et(i,l,a))}Zt("",!0),te=!0}),Je=(r,t=!1)=>{if(!te)throw new Error("jieba not loaded");return Zt(r,t)},Dn={n:void 0,f:void 0,s:void 0,t:void 0,nr:void 0,ns:void 0,nt:void 0,nw:void 0,nz:void 0,v:void 0,vd:void 0,vn:void 0,a:void 0,ad:void 0,an:void 0,d:void 0,m:void 0,q:void 0,r:void 0,p:void 0,c:void 0,u:void 0,xc:void 0,w:void 0,PER:void 0,LOC:void 0,ORG:void 0,TIME:void 0};var I=C(require("obsidian")),ee={hmm:!1,dict:""},ne=class extends I.PluginSettingTab{constructor(t){super(t.app,t);this.plugin=t}display(){let{containerEl:t}=this;t.empty(),this.addToggle(t,"hmm").setName("\u65B0\u8BCD\u53D1\u73B0\u529F\u80FD").setDesc("\u91C7\u7528\u57FA\u4E8E\u6C49\u5B57\u6210\u8BCD\u80FD\u529B\u7684 HMM \u6A21\u578B\uFF0C\u4F7F\u7528 Viterbi \u7B97\u6CD5\u63A8\u7B97\u672A\u5B58\u5728\u4E8E\u8BCD\u5E93\u5185\u7684\u8BCD\u3002\u82E5\u6548\u679C\u4E0D\u7406\u60F3\uFF0C\u53EF\u9009\u62E9\u5173\u95ED\u6B64\u9009\u9879"),this.addTextField(t,{get:"dict",set:"dict"},{cols:30,rows:5}).setName("\u7528\u6237\u81EA\u5B9A\u4E49\u8BCD\u5178").setDesc(createFragment(e=>{e.appendText("\u901A\u8FC7\u7528\u6237\u81EA\u5B9A\u4E49\u8BCD\u5178\u6765\u589E\u5F3A\u6B67\u4E49\u7EA0\u9519\u80FD\u529B"),e.createEl("br"),e.appendText("\u8BCD\u5178\u683C\u5F0F\uFF1A\u4E00\u4E2A\u8BCD\u5360\u4E00\u884C\uFF1B\u6BCF\u4E00\u884C\u5206\u4E09\u90E8\u5206\uFF1A\u8BCD\u8BED\u3001\u8BCD\u9891\uFF08\u53EF\u7701\u7565\uFF09\u3001\u8BCD\u6027\uFF08\u53EF\u7701\u7565\uFF09\uFF0C\u7528\u7A7A\u683C\u9694\u5F00\uFF0C\u987A\u5E8F\u4E0D\u53EF\u98A0\u5012"),e.createEl("br"),e.appendText("\u6309\u4E0B\u6309\u94AE\u751F\u6548")})).addButton(e=>e.setIcon("reset").setTooltip("\u91CD\u65B0\u52A0\u8F7D\u8BCD\u5178").onClick(()=>k(this,null,function*(){yield this.app.plugins.disablePlugin(this.plugin.manifest.id),yield this.app.plugins.enablePlugin(this.plugin.manifest.id),this.app.setting.openTabById(this.plugin.manifest.id)})))}addToggle(t,e){return new I.Setting(t).addToggle(n=>{n.setValue(this.plugin.settings[e]).onChange(i=>(this.plugin.settings[e]=i,this.plugin.saveSettings()))})}addTextField(t,e,n={},i=500){return new I.Setting(t).addTextArea(o=>{let{get:s,set:l}=e,a=typeof s=="function"?s:()=>this.plugin.settings[s],h=typeof l=="function"?l:c=>this.plugin.settings[l]=c,u=c=>k(this,null,function*(){h(c),yield this.plugin.saveSettings()});o.setValue(a()).onChange((0,I.debounce)(u,i,!0)),Object.assign(o.inputEl,z({cols:30,rows:5},n))})}};var Mt=6,ie=class extends Ye.Plugin{constructor(){super(...arguments);this.libName="jieba_rs_wasm_bg.wasm";this.settings=ee}get libPath(){return this.app.vault.configDir+"/"+this.libName}onload(){return k(this,null,function*(){this.addSettingTab(new ne(this)),yield this.loadSettings(),(yield this.loadJieba())&&(he(this),Fe(this),console.info("editor word splitting patched"))})}loadJieba(){return k(this,null,function*(){let{vault:t}=this.app;return(yield t.adapter.exists(this.libPath,!0))?(yield Ke(this.app.vault.adapter.readBinary(this.libPath),this.settings.dict),console.info("Jieba loaded"),!0):(new bt(this).open(),!1)})}loadSettings(){return k(this,null,function*(){this.settings=z(z({},ee),yield this.loadData())})}saveSettings(){return k(this,null,function*(){yield this.saveData(this.settings)})}cut(t){return Je(t,this.settings.hmm)}getChsSegFromRange(t,e){let{from:n,to:i,text:o}=e;if(/[\u4e00-\u9fa5]/.test(o)){if(t-n>Mt){let u=t-Mt;o=o.slice(u-n),n=u}if(i-t>Mt){let u=t+Mt;o=o.slice(0,u-i),i=u}let s=this.cut(o),l=0,a=0,h=t-n;for(let u of s){if(a=l+u.length,h>=l&&h<a)break;l+=u.length}return i=a+n,n+=l,{from:n,to:i}}else return null}};
